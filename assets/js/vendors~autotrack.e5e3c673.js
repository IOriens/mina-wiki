(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{390:function(t,e,i){"use strict";i.r(e);const s=window.Element.prototype,n=s.matches||s.matchesSelector||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector||s.oMatchesSelector;function r(t,e){if(t&&1==t.nodeType&&e){if("string"==typeof e||1==e.nodeType)return t==e||o(t,e);if("length"in e)for(let i,s=0;i=e[s];s++)if(t==i||o(t,i))return!0}return!1}function o(t,e){if("string"!=typeof e)return!1;if(n)return n.call(t,e);const i=t.parentNode.querySelectorAll(e);for(let e,s=0;e=i[s];s++)if(e==t)return!0;return!1}function a(t,e,i,s,n={}){const o=function(t){let e;if(n.composed&&"function"==typeof t.composedPath){const s=t.composedPath();for(let t,n=0;t=s[n];n++)1==t.nodeType&&r(t,i)&&(e=t)}else e=function(t,e,i=!1){if(!t||1!=t.nodeType||!e)return;const s=(i?[t]:[]).concat(function(t){const e=[];for(;t&&t.parentNode&&1==t.parentNode.nodeType;)t=t.parentNode,e.push(t);return e}(t));for(let t,i=0;t=s[i];i++)if(r(t,e))return t}(t.target,i,!0);e&&s.call(e,t,e)};return t.addEventListener(e,o,n.useCapture),{destroy:function(){t.removeEventListener(e,o,n.useCapture)}}}const h="80",d="443",l=RegExp(":("+h+"|"+d+")$"),c=document.createElement("a"),u={};function p(t){if(t=t&&"."!=t?t:location.href,u[t])return u[t];if(c.href=t,"."==t.charAt(0)||"/"==t.charAt(0))return p(c.href);let e=c.port==h||c.port==d?"":c.port;e="0"==e?"":e;const i=c.host.replace(l,""),s=c.origin?c.origin:c.protocol+"//"+i,n="/"==c.pathname.charAt(0)?c.pathname:"/"+c.pathname;return u[t]={hash:c.hash,host:i,hostname:c.hostname,href:c.href,origin:s,pathname:n,port:e,protocol:c.protocol,search:c.search}}const m="2.4.1",g="i5iSjo",v="_av",f="_au",b="(not set)",w=[];class k{static add(t,e,i){E(t,e).add(i)}static remove(t,e,i){E(t,e).remove(i)}constructor(t,e){this.context=t,this.methodName=e,this.isTask=/Task$/.test(e),this.originalMethodReference=this.isTask?t.get(e):t[e],this.methodChain=[],this.boundMethodChain=[],this.wrappedMethod=(...t)=>{return(0,this.boundMethodChain[this.boundMethodChain.length-1])(...t)},this.isTask?t.set(e,this.wrappedMethod):t[e]=this.wrappedMethod}add(t){this.methodChain.push(t),this.rebindMethodChain()}remove(t){const e=this.methodChain.indexOf(t);e>-1&&(this.methodChain.splice(e,1),this.methodChain.length>0?this.rebindMethodChain():this.destroy())}rebindMethodChain(){this.boundMethodChain=[];for(let t,e=0;t=this.methodChain[e];e++){const i=this.boundMethodChain[e-1]||this.originalMethodReference.bind(this.context);this.boundMethodChain.push(t(i))}}destroy(){const t=w.indexOf(this);t>-1&&(w.splice(t,1),this.isTask?this.context.set(this.methodName,this.originalMethodReference):this.context[this.methodName]=this.originalMethodReference)}}function E(t,e){let i=w.filter(i=>i.context==t&&i.methodName==e)[0];return i||(i=new k(t,e),w.push(i)),i}function T(t,e,i,s,n,r){if("function"==typeof s){const o=i.get("buildHitTask");return{buildHitTask:i=>{i.set(t,null,!0),i.set(e,null,!0),s(i,n,r),o(i)}}}return I({},t,e)}function y(t,e){const i=function(t){const e={};if(!t||1!=t.nodeType)return e;const i=t.attributes;if(0===i.length)return{};for(let t,s=0;t=i[s];s++)e[t.name]=t.value;return e}(t),s={};return Object.keys(i).forEach((function(t){if(0===t.indexOf(e)&&t!=e+"on"){let n=i[t];"true"==n&&(n=!0),"false"==n&&(n=!1);const r=t.slice(e.length).replace(/[\-\_]+(\w?)/g,(function(t,e){return e.toUpperCase()}));s[r]=n}})),s}function O(t,e){let i;return function(...s){clearTimeout(i),i=setTimeout(()=>t(...s),e)}}function S(t,e=2e3){let i=!1;const s=function(){i||(i=!0,t())};return setTimeout(s,e),s}const M={};const I=Object.assign||function(t,...e){for(let i=0,s=e.length;i<s;i++){const s=Object(e[i]);for(let e in s)Object.prototype.hasOwnProperty.call(s,e)&&(t[e]=s[e])}return t};function C(t){return"object"==typeof t&&null!==t}function L(){return+new Date}const _=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)};function F(t,e){const i=window.GoogleAnalyticsObject||"ga";var s;window[i]=window[i]||function(...t){(window[i].q=window[i].q||[]).push(t)},window.gaDevIds=window.gaDevIds||[],window.gaDevIds.indexOf(g)<0&&window.gaDevIds.push(g),window[i]("provide",t,e),window.gaplugins=window.gaplugins||{},window.gaplugins[(s=t,s.charAt(0).toUpperCase()+s.slice(1))]=e}const x={CLEAN_URL_TRACKER:1,EVENT_TRACKER:2,IMPRESSION_TRACKER:3,MEDIA_QUERY_TRACKER:4,OUTBOUND_FORM_TRACKER:5,OUTBOUND_LINK_TRACKER:6,PAGE_VISIBILITY_TRACKER:7,SOCIAL_WIDGET_TRACKER:8,URL_CHANGE_TRACKER:9,MAX_SCROLL_TRACKER:10},A=Object.keys(x).length;function P(t,e){!function(t){t.set("&"+v,m)}(t),function(t,e){let i=function(t,e){if(t.length<e){let i=e-t.length;for(;i;)t="0"+t,i--}return t}((s=t.get("&"+f),parseInt(s||"0",16).toString(2)),A);var s;r=i,o=A-e,i=r.substr(0,o)+1+r.substr(o+1),t.set("&"+f,(n=i,parseInt(n||"0",2).toString(16)));var n;var r,o}(t,e)}F("cleanUrlTracker",class{constructor(t,e){P(t,x.CLEAN_URL_TRACKER);this.opts=I({},e),this.tracker=t,this.queryDimension=this.opts.stripQuery&&this.opts.queryDimensionIndex?`dimension${this.opts.queryDimensionIndex}`:null,this.trackerGetOverride=this.trackerGetOverride.bind(this),this.buildHitTaskOverride=this.buildHitTaskOverride.bind(this),k.add(t,"get",this.trackerGetOverride),k.add(t,"buildHitTask",this.buildHitTaskOverride)}trackerGetOverride(t){return e=>{if("page"==e||e==this.queryDimension){const i={location:t("location"),page:t("page")};return this.cleanUrlFields(i)[e]}return t(e)}}buildHitTaskOverride(t){return e=>{const i=this.cleanUrlFields({location:e.get("location"),page:e.get("page")});e.set(i,null,!0),t(e)}}cleanUrlFields(t){const e=p(t.page||t.location);let i=e.pathname;if(this.opts.indexFilename){const t=i.split("/");this.opts.indexFilename==t[t.length-1]&&(t[t.length-1]="",i=t.join("/"))}if("remove"==this.opts.trailingSlash)i=i.replace(/\/+$/,"");else if("add"==this.opts.trailingSlash){/\.\w+$/.test(i)||"/"==i.substr(-1)||(i+="/")}const s={page:i+(this.opts.stripQuery?this.stripNonWhitelistedQueryParams(e.search):e.search)};if(t.location&&(s.location=t.location),this.queryDimension&&(s[this.queryDimension]=e.search.slice(1)||b),"function"==typeof this.opts.urlFieldsFilter){const t=this.opts.urlFieldsFilter(s,p),e={page:t.page,location:t.location};return this.queryDimension&&(e[this.queryDimension]=t[this.queryDimension]),e}return s}stripNonWhitelistedQueryParams(t){if(Array.isArray(this.opts.queryParamsWhitelist)){const e=[];return t.slice(1).split("&").forEach(t=>{const[i,s]=t.split("=");this.opts.queryParamsWhitelist.indexOf(i)>-1&&s&&e.push([i,s])}),e.length?"?"+e.map(t=>t.join("=")).join("&"):""}return""}remove(){k.remove(this.tracker,"get",this.trackerGetOverride),k.remove(this.tracker,"buildHitTask",this.buildHitTaskOverride)}});F("eventTracker",class{constructor(t,e){if(P(t,x.EVENT_TRACKER),!window.addEventListener)return;this.opts=I({events:["click"],fieldsObj:{},attributePrefix:"ga-"},e),this.tracker=t,this.handleEvents=this.handleEvents.bind(this);const i="["+this.opts.attributePrefix+"on]";this.delegates={},this.opts.events.forEach(t=>{this.delegates[t]=a(document,t,i,this.handleEvents,{composed:!0,useCapture:!0})})}handleEvents(t,e){const i=this.opts.attributePrefix;if(e.getAttribute(i+"on").split(/\s*,\s*/).indexOf(t.type)<0)return;const s=y(e,i),n=I({},this.opts.fieldsObj,s),r=s.hitType||"event";this.tracker.send(r,T({transport:"beacon"},n,this.tracker,this.opts.hitFilter,e,t))}remove(){Object.keys(this.delegates).forEach(t=>{this.delegates[t].destroy()})}});function R(t,e){if(0===t){const t=e.intersectionRect;return t.top>0||t.bottom>0||t.left>0||t.right>0}return e.intersectionRatio>=t}function D(t){return"string"==typeof t&&(t={id:t}),I({threshold:0,trackFirstImpressionOnly:!0},t)}F("impressionTracker",class{constructor(t,e){if(P(t,x.IMPRESSION_TRACKER),!window.IntersectionObserver||!window.MutationObserver)return;var i;this.opts=I({rootMargin:"0px",fieldsObj:{},attributePrefix:"ga-"},e),this.tracker=t,this.handleDomMutations=this.handleDomMutations.bind(this),this.handleIntersectionChanges=this.handleIntersectionChanges.bind(this),this.handleDomElementAdded=this.handleDomElementAdded.bind(this),this.handleDomElementRemoved=this.handleDomElementRemoved.bind(this),this.mutationObserver=null,this.items=[],this.elementMap={},this.thresholdMap={},i=()=>{this.opts.elements&&this.observeElements(this.opts.elements)},"loading"==document.readyState?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),i()})):i()}observeElements(t){const e=this.deriveDataFromElements(t);this.items=this.items.concat(e.items),this.elementMap=I({},e.elementMap,this.elementMap),this.thresholdMap=I({},e.thresholdMap,this.thresholdMap),e.items.forEach(t=>{const e=this.thresholdMap[t.threshold]=this.thresholdMap[t.threshold]||new IntersectionObserver(this.handleIntersectionChanges,{rootMargin:this.opts.rootMargin,threshold:[+t.threshold]}),i=this.elementMap[t.id]||(this.elementMap[t.id]=document.getElementById(t.id));i&&e.observe(i)}),this.mutationObserver||(this.mutationObserver=new MutationObserver(this.handleDomMutations),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0})),requestAnimationFrame(()=>{})}unobserveElements(t){const e=[],i=[];if(this.items.forEach(s=>{t.some(t=>{const e=D(t);return e.id===s.id&&e.threshold===s.threshold&&e.trackFirstImpressionOnly===s.trackFirstImpressionOnly})?i.push(s):e.push(s)}),e.length){const t=this.deriveDataFromElements(e),s=this.deriveDataFromElements(i);this.items=t.items,this.elementMap=t.elementMap,this.thresholdMap=t.thresholdMap,i.forEach(e=>{if(!t.elementMap[e.id]){const i=s.thresholdMap[e.threshold],n=s.elementMap[e.id];n&&i.unobserve(n),t.thresholdMap[e.threshold]||s.thresholdMap[e.threshold].disconnect()}})}else this.unobserveAllElements()}unobserveAllElements(){Object.keys(this.thresholdMap).forEach(t=>{this.thresholdMap[t].disconnect()}),this.mutationObserver.disconnect(),this.mutationObserver=null,this.items=[],this.elementMap={},this.thresholdMap={}}deriveDataFromElements(t){const e=[],i={},s={};return t.length&&t.forEach(t=>{const n=D(t);e.push(n),s[n.id]=this.elementMap[n.id]||null,i[n.threshold]=this.thresholdMap[n.threshold]||null}),{items:e,elementMap:s,thresholdMap:i}}handleDomMutations(t){for(let e,i=0;e=t[i];i++){for(let t,i=0;t=e.removedNodes[i];i++)this.walkNodeTree(t,this.handleDomElementRemoved);for(let t,i=0;t=e.addedNodes[i];i++)this.walkNodeTree(t,this.handleDomElementAdded)}}walkNodeTree(t,e){1==t.nodeType&&t.id in this.elementMap&&e(t.id);for(let i,s=0;i=t.childNodes[s];s++)this.walkNodeTree(i,e)}handleIntersectionChanges(t){const e=[];for(let i,s=0;i=t[s];s++)for(let t,s=0;t=this.items[s];s++)i.target.id===t.id&&R(t.threshold,i)&&(this.handleImpression(t.id),t.trackFirstImpressionOnly&&e.push(t));e.length&&this.unobserveElements(e)}handleImpression(t){const e=document.getElementById(t),i={transport:"beacon",eventCategory:"Viewport",eventAction:"impression",eventLabel:t,nonInteraction:!0},s=I({},this.opts.fieldsObj,y(e,this.opts.attributePrefix));this.tracker.send("event",T(i,s,this.tracker,this.opts.hitFilter,e))}handleDomElementAdded(t){const e=this.elementMap[t]=document.getElementById(t);this.items.forEach(i=>{t==i.id&&this.thresholdMap[i.threshold].observe(e)})}handleDomElementRemoved(t){const e=this.elementMap[t];this.items.forEach(i=>{t==i.id&&this.thresholdMap[i.threshold].unobserve(e)}),this.elementMap[t]=null}remove(){this.unobserveAllElements()}});class U{constructor(){this.registry_={}}on(t,e){this.getRegistry_(t).push(e)}off(t,e){if(t&&e){const i=this.getRegistry_(t),s=i.indexOf(e);s>-1&&i.splice(s,1)}else this.registry_={}}emit(t,...e){this.getRegistry_(t).forEach(t=>t(...e))}getEventCount(){let t=0;return Object.keys(this.registry_).forEach(e=>{t+=this.getRegistry_(e).length}),t}getRegistry_(t){return this.registry_[t]=this.registry_[t]||[]}}const j="autotrack",N={};let H,K=!1;class q extends U{static getOrCreate(t,e,i){const s=[j,t,e].join(":");return N[s]||(N[s]=new q(s,i),K||(window.addEventListener("storage",W),K=!0)),N[s]}static isSupported_(){if(null!=H)return H;try{window.localStorage.setItem(j,j),window.localStorage.removeItem(j),H=!0}catch(t){H=!1}return H}static get_(t){return window.localStorage.getItem(t)}static set_(t,e){window.localStorage.setItem(t,e)}static clear_(t){window.localStorage.removeItem(t)}constructor(t,e={}){super(),this.key_=t,this.defaults_=e,this.cache_=null}get(){if(this.cache_)return this.cache_;if(q.isSupported_())try{this.cache_=V(q.get_(this.key_))}catch(t){}return this.cache_=I({},this.defaults_,this.cache_)}set(t){if(this.cache_=I({},this.defaults_,this.cache_,t),q.isSupported_())try{q.set_(this.key_,JSON.stringify(this.cache_))}catch(t){}}clear(){if(this.cache_={},q.isSupported_())try{q.clear_(this.key_)}catch(t){}}destroy(){delete N[this.key_],Object.keys(N).length||(window.removeEventListener("storage",W),K=!1)}}function W(t){const e=N[t.key];if(e){const i=I({},e.defaults_,V(t.oldValue)),s=I({},e.defaults_,V(t.newValue));e.cache_=s,e.emit("externalSet",s,i)}}function V(t){let e={};if(t)try{e=JSON.parse(t)}catch(t){}return e}const B=6e4,G={};class Q{static getOrCreate(t,e,i){const s=t.get("trackingId");return G[s]?G[s]:G[s]=new Q(t,e,i)}constructor(t,e,i){this.tracker=t,this.timeout=e||Q.DEFAULT_TIMEOUT,this.timeZone=i,this.sendHitTaskOverride=this.sendHitTaskOverride.bind(this),k.add(t,"sendHitTask",this.sendHitTaskOverride);try{this.dateTimeFormatter=new Intl.DateTimeFormat("en-US",{timeZone:this.timeZone})}catch(t){}this.store=q.getOrCreate(t.get("trackingId"),"session",{hitTime:0,isExpired:!1}),this.store.get().id||this.store.set({id:_()})}getId(){return this.store.get().id}isExpired(t=this.getId()){if(t!=this.getId())return!0;const e=this.store.get();if(e.isExpired)return!0;const i=e.hitTime;if(i){const t=new Date,e=new Date(i);if(t-e>this.timeout*B||this.datesAreDifferentInTimezone(t,e))return!0}return!1}datesAreDifferentInTimezone(t,e){return!!this.dateTimeFormatter&&this.dateTimeFormatter.format(t)!=this.dateTimeFormatter.format(e)}sendHitTaskOverride(t){return e=>{t(e);const i=e.get("sessionControl"),s="start"==i||this.isExpired(),n="end"==i,r=this.store.get();r.hitTime=L(),s&&(r.isExpired=!1,r.id=_()),n&&(r.isExpired=!0),this.store.set(r)}}destroy(){k.remove(this.tracker,"sendHitTask",this.sendHitTaskOverride),this.store.destroy(),delete G[this.tracker.get("trackingId")]}}Q.DEFAULT_TIMEOUT=30;F("maxScrollTracker",class{constructor(t,e){if(P(t,x.MAX_SCROLL_TRACKER),!window.addEventListener)return;const i={increaseThreshold:20,sessionTimeout:Q.DEFAULT_TIMEOUT,fieldsObj:{}};this.opts=I(i,e),this.tracker=t,this.pagePath=this.getPagePath(),this.handleScroll=O(this.handleScroll.bind(this),500),this.trackerSetOverride=this.trackerSetOverride.bind(this),this.store=q.getOrCreate(t.get("trackingId"),"plugins/max-scroll-tracker"),this.session=Q.getOrCreate(t,this.opts.sessionTimeout,this.opts.timeZone),k.add(t,"set",this.trackerSetOverride),this.listenForMaxScrollChanges()}listenForMaxScrollChanges(){this.getMaxScrollPercentageForCurrentPage()<100&&window.addEventListener("scroll",this.handleScroll)}stopListeningForMaxScrollChanges(){window.removeEventListener("scroll",this.handleScroll)}handleScroll(){const t=function(){const t=document.documentElement,e=document.body;return Math.max(t.offsetHeight,t.scrollHeight,e.offsetHeight,e.scrollHeight)}(),e=window.pageYOffset,i=window.innerHeight,s=Math.min(100,Math.max(0,Math.round(e/(t-i)*100))),n=this.session.getId();if(n!=this.store.get().sessionId&&(this.store.clear(),this.store.set({sessionId:n})),this.session.isExpired(this.store.get().sessionId))this.store.clear();else{const t=this.getMaxScrollPercentageForCurrentPage();if(s>t){100!=s&&100!=t||this.stopListeningForMaxScrollChanges();const e=s-t;(100==s||e>=this.opts.increaseThreshold)&&(this.setMaxScrollPercentageForCurrentPage(s),this.sendMaxScrollEvent(e,s))}}}trackerSetOverride(t){return(e,i)=>{if(t(e,i),(C(e)?e:{[e]:i}).page){const t=this.pagePath;this.pagePath=this.getPagePath(),this.pagePath!=t&&this.listenForMaxScrollChanges()}}}sendMaxScrollEvent(t,e){const i={transport:"beacon",eventCategory:"Max Scroll",eventAction:"increase",eventValue:t,eventLabel:String(e),nonInteraction:!0};this.opts.maxScrollMetricIndex&&(i["metric"+this.opts.maxScrollMetricIndex]=t),this.tracker.send("event",T(i,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}setMaxScrollPercentageForCurrentPage(t){this.store.set({[this.pagePath]:t,sessionId:this.session.getId()})}getMaxScrollPercentageForCurrentPage(){return this.store.get()[this.pagePath]||0}getPagePath(){const t=p(this.tracker.get("page")||this.tracker.get("location"));return t.pathname+t.search}remove(){this.session.destroy(),this.stopListeningForMaxScrollChanges(),k.remove(this.tracker,"set",this.trackerSetOverride)}});const Y={};function Z(t){return Y[t]||(Y[t]=window.matchMedia(t))}F("mediaQueryTracker",class{constructor(t,e){if(P(t,x.MEDIA_QUERY_TRACKER),!window.matchMedia)return;const i={changeTemplate:this.changeTemplate,changeTimeout:1e3,fieldsObj:{}};var s;(this.opts=I(i,e),C(this.opts.definitions))&&(this.opts.definitions=(s=this.opts.definitions,Array.isArray(s)?s:[s]),this.tracker=t,this.changeListeners=[],this.processMediaQueries())}processMediaQueries(){this.opts.definitions.forEach(t=>{if(t.name&&t.dimensionIndex){const e=this.getMatchName(t);this.tracker.set("dimension"+t.dimensionIndex,e),this.addChangeListeners(t)}})}getMatchName(t){let e;return t.items.forEach(t=>{Z(t.media).matches&&(e=t)}),e?e.name:b}addChangeListeners(t){t.items.forEach(e=>{const i=Z(e.media),s=O(()=>{this.handleChanges(t)},this.opts.changeTimeout);i.addListener(s),this.changeListeners.push({mql:i,fn:s})})}handleChanges(t){const e=this.getMatchName(t),i=this.tracker.get("dimension"+t.dimensionIndex);if(e!==i){this.tracker.set("dimension"+t.dimensionIndex,e);const s={transport:"beacon",eventCategory:t.name,eventAction:"change",eventLabel:this.opts.changeTemplate(i,e),nonInteraction:!0};this.tracker.send("event",T(s,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}}remove(){for(let t,e=0;t=this.changeListeners[e];e++)t.mql.removeListener(t.fn)}changeTemplate(t,e){return t+" => "+e}});F("outboundFormTracker",class{constructor(t,e){if(P(t,x.OUTBOUND_FORM_TRACKER),!window.addEventListener)return;const i={formSelector:"form",shouldTrackOutboundForm:this.shouldTrackOutboundForm,fieldsObj:{},attributePrefix:"ga-"};this.opts=I(i,e),this.tracker=t,this.delegate=a(document,"submit",this.opts.formSelector,this.handleFormSubmits.bind(this),{composed:!0,useCapture:!0})}handleFormSubmits(t,e){const i={transport:"beacon",eventCategory:"Outbound Form",eventAction:"submit",eventLabel:p(e.action).href};if(this.opts.shouldTrackOutboundForm(e,p)){navigator.sendBeacon||(t.preventDefault(),i.hitCallback=S((function(){e.submit()})));const s=I({},this.opts.fieldsObj,y(e,this.opts.attributePrefix));this.tracker.send("event",T(i,s,this.tracker,this.opts.hitFilter,e,t))}}shouldTrackOutboundForm(t,e){const i=e(t.action);return i.hostname!=location.hostname&&"http"==i.protocol.slice(0,4)}remove(){this.delegate.destroy()}});F("outboundLinkTracker",class{constructor(t,e){if(P(t,x.OUTBOUND_LINK_TRACKER),!window.addEventListener)return;const i={events:["click"],linkSelector:"a, area",shouldTrackOutboundLink:this.shouldTrackOutboundLink,fieldsObj:{},attributePrefix:"ga-"};this.opts=I(i,e),this.tracker=t,this.handleLinkInteractions=this.handleLinkInteractions.bind(this),this.delegates={},this.opts.events.forEach(t=>{this.delegates[t]=a(document,t,this.opts.linkSelector,this.handleLinkInteractions,{composed:!0,useCapture:!0})})}handleLinkInteractions(t,e){if(this.opts.shouldTrackOutboundLink(e,p)){const i=e.getAttribute("href")||e.getAttribute("xlink:href"),s=p(i),n=T({transport:"beacon",eventCategory:"Outbound Link",eventAction:t.type,eventLabel:s.href},I({},this.opts.fieldsObj,y(e,this.opts.attributePrefix)),this.tracker,this.opts.hitFilter,e,t);if(!navigator.sendBeacon&&function(t,e){return!("click"!=t.type||"_blank"==e.target||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.which>1)}(t,e)){const e=()=>{if(window.removeEventListener("click",e),!t.defaultPrevented){t.preventDefault();const e=n.hitCallback;n.hitCallback=S((function(){"function"==typeof e&&e(),location.href=i}))}this.tracker.send("event",n)};window.addEventListener("click",e)}else this.tracker.send("event",n)}}shouldTrackOutboundLink(t,e){const i=e(t.getAttribute("href")||t.getAttribute("xlink:href"));return i.hostname!=location.hostname&&"http"==i.protocol.slice(0,4)}remove(){Object.keys(this.delegates).forEach(t=>{this.delegates[t].destroy()})}});const $="hidden",J="visible",z=_(),X=1e3;F("pageVisibilityTracker",class{constructor(t,e){if(P(t,x.PAGE_VISIBILITY_TRACKER),!document.visibilityState)return;const i={sessionTimeout:Q.DEFAULT_TIMEOUT,visibleThreshold:5*X,sendInitialPageview:!1,fieldsObj:{}};this.opts=I(i,e),this.tracker=t,this.lastPageState=document.visibilityState,this.visibleThresholdTimeout_=null,this.isInitialPageviewSent_=!1,this.trackerSetOverride=this.trackerSetOverride.bind(this),this.handleChange=this.handleChange.bind(this),this.handleWindowUnload=this.handleWindowUnload.bind(this),this.handleExternalStoreSet=this.handleExternalStoreSet.bind(this),this.store=q.getOrCreate(t.get("trackingId"),"plugins/page-visibility-tracker"),this.store.on("externalSet",this.handleExternalStoreSet),this.session=Q.getOrCreate(t,this.opts.sessionTimeout,this.opts.timeZone),k.add(t,"set",this.trackerSetOverride),window.addEventListener("unload",this.handleWindowUnload),document.addEventListener("visibilitychange",this.handleChange),function(t,e){const i=t.get("trackingId"),s=M[i]=M[i]||{},n=()=>{clearTimeout(s.timeout),s.send&&k.remove(t,"send",s.send),delete M[i],s.queue.forEach(t=>t())};clearTimeout(s.timeout),s.timeout=setTimeout(n,0),s.queue=s.queue||[],s.queue.push(e),s.send||(s.send=t=>(...e)=>{n(),t(...e)},k.add(t,"send",s.send))}(this.tracker,()=>{document.visibilityState==J?(this.opts.sendInitialPageview&&(this.sendPageview({isPageLoad:!0}),this.isInitialPageviewSent_=!0),this.store.set({time:L(),state:J,pageId:z,sessionId:this.session.getId()})):this.opts.sendInitialPageview&&this.opts.pageLoadsMetricIndex&&this.sendPageLoad()})}handleChange(){if(document.visibilityState!=J&&document.visibilityState!=$)return;const t=this.getAndValidateChangeData(),e={time:L(),state:document.visibilityState,pageId:z,sessionId:this.session.getId()};document.visibilityState==J&&this.opts.sendInitialPageview&&!this.isInitialPageviewSent_&&(this.sendPageview(),this.isInitialPageviewSent_=!0),document.visibilityState==$&&this.visibleThresholdTimeout_&&clearTimeout(this.visibleThresholdTimeout_),this.session.isExpired(t.sessionId)?(this.store.clear(),this.lastPageState==$&&document.visibilityState==J&&(clearTimeout(this.visibleThresholdTimeout_),this.visibleThresholdTimeout_=setTimeout(()=>{this.store.set(e),this.sendPageview({hitTime:e.time})},this.opts.visibleThreshold))):(t.pageId==z&&t.state==J&&this.sendPageVisibilityEvent(t),this.store.set(e)),this.lastPageState=document.visibilityState}getAndValidateChangeData(){const t=this.store.get();return this.lastPageState==J&&t.state==$&&t.pageId!=z&&(t.state=J,t.pageId=z,this.store.set(t)),t}sendPageVisibilityEvent(t,{hitTime:e}={}){const i=this.getTimeSinceLastStoredChange(t,{hitTime:e});if(i&&i>=this.opts.visibleThreshold){const t=Math.round(i/X),s={transport:"beacon",nonInteraction:!0,eventCategory:"Page Visibility",eventAction:"track",eventValue:t,eventLabel:b};e&&(s.queueTime=L()-e),this.opts.visibleMetricIndex&&(s["metric"+this.opts.visibleMetricIndex]=t),this.tracker.send("event",T(s,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}}sendPageLoad(){const t={transport:"beacon",eventCategory:"Page Visibility",eventAction:"page load",eventLabel:b,["metric"+this.opts.pageLoadsMetricIndex]:1,nonInteraction:!0};this.tracker.send("event",T(t,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}sendPageview({hitTime:t,isPageLoad:e}={}){const i={transport:"beacon"};t&&(i.queueTime=L()-t),e&&this.opts.pageLoadsMetricIndex&&(i["metric"+this.opts.pageLoadsMetricIndex]=1),this.tracker.send("pageview",T(i,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}trackerSetOverride(t){return(e,i)=>{const s=C(e)?e:{[e]:i};s.page&&s.page!==this.tracker.get("page")&&this.lastPageState==J&&this.handleChange(),t(e,i)}}getTimeSinceLastStoredChange(t,{hitTime:e}={}){return t.time?(e||L())-t.time:0}handleExternalStoreSet(t,e){t.time!=e.time&&(e.pageId!=z||e.state!=J||this.session.isExpired(e.sessionId)||this.sendPageVisibilityEvent(e,{hitTime:t.time}))}handleWindowUnload(){this.lastPageState!=$&&this.handleChange()}remove(){this.store.destroy(),this.session.destroy(),k.remove(this.tracker,"set",this.trackerSetOverride),window.removeEventListener("unload",this.handleWindowUnload),document.removeEventListener("visibilitychange",this.handleChange)}});F("socialWidgetTracker",class{constructor(t,e){if(P(t,x.SOCIAL_WIDGET_TRACKER),!window.addEventListener)return;this.opts=I({fieldsObj:{},hitFilter:null},e),this.tracker=t,this.addWidgetListeners=this.addWidgetListeners.bind(this),this.addTwitterEventHandlers=this.addTwitterEventHandlers.bind(this),this.handleTweetEvents=this.handleTweetEvents.bind(this),this.handleFollowEvents=this.handleFollowEvents.bind(this),this.handleLikeEvents=this.handleLikeEvents.bind(this),this.handleUnlikeEvents=this.handleUnlikeEvents.bind(this),"complete"!=document.readyState?window.addEventListener("load",this.addWidgetListeners):this.addWidgetListeners()}addWidgetListeners(){window.FB&&this.addFacebookEventHandlers(),window.twttr&&this.addTwitterEventHandlers()}addTwitterEventHandlers(){try{window.twttr.ready(()=>{window.twttr.events.bind("tweet",this.handleTweetEvents),window.twttr.events.bind("follow",this.handleFollowEvents)})}catch(t){}}removeTwitterEventHandlers(){try{window.twttr.ready(()=>{window.twttr.events.unbind("tweet",this.handleTweetEvents),window.twttr.events.unbind("follow",this.handleFollowEvents)})}catch(t){}}addFacebookEventHandlers(){try{window.FB.Event.subscribe("edge.create",this.handleLikeEvents),window.FB.Event.subscribe("edge.remove",this.handleUnlikeEvents)}catch(t){}}removeFacebookEventHandlers(){try{window.FB.Event.unsubscribe("edge.create",this.handleLikeEvents),window.FB.Event.unsubscribe("edge.remove",this.handleUnlikeEvents)}catch(t){}}handleTweetEvents(t){if("tweet"!=t.region)return;const e={transport:"beacon",socialNetwork:"Twitter",socialAction:"tweet",socialTarget:t.data.url||t.target.getAttribute("data-url")||location.href};this.tracker.send("social",T(e,this.opts.fieldsObj,this.tracker,this.opts.hitFilter,t.target,t))}handleFollowEvents(t){if("follow"!=t.region)return;const e={transport:"beacon",socialNetwork:"Twitter",socialAction:"follow",socialTarget:t.data.screen_name||t.target.getAttribute("data-screen-name")};this.tracker.send("social",T(e,this.opts.fieldsObj,this.tracker,this.opts.hitFilter,t.target,t))}handleLikeEvents(t){const e={transport:"beacon",socialNetwork:"Facebook",socialAction:"like",socialTarget:t};this.tracker.send("social",T(e,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}handleUnlikeEvents(t){const e={transport:"beacon",socialNetwork:"Facebook",socialAction:"unlike",socialTarget:t};this.tracker.send("social",T(e,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}remove(){window.removeEventListener("load",this.addWidgetListeners),this.removeFacebookEventHandlers(),this.removeTwitterEventHandlers()}});function tt(){return location.pathname+location.search}F("urlChangeTracker",class{constructor(t,e){if(P(t,x.URL_CHANGE_TRACKER),!history.pushState||!window.addEventListener)return;const i={shouldTrackUrlChange:this.shouldTrackUrlChange,trackReplaceState:!1,fieldsObj:{},hitFilter:null};this.opts=I(i,e),this.tracker=t,this.path=tt(),this.pushStateOverride=this.pushStateOverride.bind(this),this.replaceStateOverride=this.replaceStateOverride.bind(this),this.handlePopState=this.handlePopState.bind(this),k.add(history,"pushState",this.pushStateOverride),k.add(history,"replaceState",this.replaceStateOverride),window.addEventListener("popstate",this.handlePopState)}pushStateOverride(t){return(...e)=>{t(...e),this.handleUrlChange(!0)}}replaceStateOverride(t){return(...e)=>{t(...e),this.handleUrlChange(!1)}}handlePopState(){this.handleUrlChange(!0)}handleUrlChange(t){setTimeout(()=>{const e=this.path,i=tt();if(e!=i&&this.opts.shouldTrackUrlChange.call(this,i,e)&&(this.path=i,this.tracker.set({page:i,title:document.title}),t||this.opts.trackReplaceState)){const t={transport:"beacon"};this.tracker.send("pageview",T(t,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}},0)}shouldTrackUrlChange(t,e){return!(!t||!e)}remove(){k.remove(history,"pushState",this.pushStateOverride),k.remove(history,"replaceState",this.replaceStateOverride),window.removeEventListener("popstate",this.handlePopState)}})}}]);